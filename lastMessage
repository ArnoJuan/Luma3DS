Cleanup, add boundary checks for files loaded from SD
